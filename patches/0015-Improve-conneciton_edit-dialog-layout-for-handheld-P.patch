From: Dave <bdbcat@yahoo.com>
Date: Fri, 9 Aug 2024 20:15:34 -0400
Subject: Improve connection_edit dialog layout ...

...for handheld Portrait mode devices.


Applied-upstream: https://github.com/OpenCPN/OpenCPN/commit/52dcec627b
---
 gui/src/connection_edit.cpp | 56 ++++++++++++++++++++++++++++++++-------------
 1 file changed, 40 insertions(+), 16 deletions(-)

diff --git a/gui/src/connection_edit.cpp b/gui/src/connection_edit.cpp
index e8b4385..ff0cfe5 100644
--- a/gui/src/connection_edit.cpp
+++ b/gui/src/connection_edit.cpp
@@ -215,6 +215,7 @@ void ConnectionEditDialog::Init() {
 
   m_BTScanTimer.SetOwner(this, ID_BT_SCANTIMER);
   m_BTscanning = 0;
+  wxSize displaySize = wxGetDisplaySize();
 
   // Create the UI
 
@@ -287,11 +288,14 @@ void ConnectionEditDialog::Init() {
   m_rbTypeCAN->Hide();
 #endif
 
+  wxBoxSizer* bSizer15a = new wxBoxSizer(wxHORIZONTAL);
+  sbSizerConnectionProps->Add(bSizer15a, 0, wxEXPAND, 5);
+
   if (OCPNPlatform::hasInternalGPS()) {
     m_rbTypeInternalGPS =
         new wxRadioButton(m_scrolledwin, wxID_ANY, _("Built-in GPS"),
                           wxDefaultPosition, wxDefaultSize, 0);
-    bSizer15->Add(m_rbTypeInternalGPS, 0, wxALL, 5);
+    bSizer15a->Add(m_rbTypeInternalGPS, 0, wxALL, 5);
   } else
     m_rbTypeInternalGPS = NULL;
 
@@ -300,7 +304,7 @@ void ConnectionEditDialog::Init() {
     m_rbTypeInternalBT =
         new wxRadioButton(m_scrolledwin, wxID_ANY, _("Built-in Bluetooth SPP"),
                           wxDefaultPosition, wxDefaultSize, 0);
-    bSizer15->Add(m_rbTypeInternalBT, 0, wxALL, 5);
+    bSizer15a->Add(m_rbTypeInternalBT, 0, wxALL, 5);
 
     m_buttonScanBT = new wxButton(m_scrolledwin, wxID_ANY, _("BT Scan"),
                                   wxDefaultPosition, wxDefaultSize);
@@ -334,7 +338,7 @@ void ConnectionEditDialog::Init() {
   } else
     m_rbTypeInternalBT = NULL;
 
-  gSizerNetProps = new wxFlexGridSizer(0, 4, 0, 0);
+  gSizerNetProps = new wxFlexGridSizer(0, 2, 0, 0);
 
   sbSizerConnectionProps->Add(gSizerNetProps, 0, wxEXPAND, 5);
 
@@ -346,6 +350,9 @@ void ConnectionEditDialog::Init() {
 
   wxBoxSizer* bSizer16;
   bSizer16 = new wxBoxSizer(wxHORIZONTAL);
+  gSizerNetProps->Add(bSizer16, 1, wxEXPAND, 5);
+  gSizerNetProps->AddSpacer(1);
+  gSizerNetProps->AddSpacer(1);
 
   m_rbNetProtoTCP =
       new wxRadioButton(m_scrolledwin, wxID_ANY, _("TCP"), wxDefaultPosition,
@@ -361,20 +368,37 @@ void ConnectionEditDialog::Init() {
 
   bSizer16->Add(m_rbNetProtoUDP, 0, wxALL, 5);
 
-  m_rbNetProtoGPSD = new wxRadioButton(m_scrolledwin, wxID_ANY, _("GPSD"),
-                                       wxDefaultPosition, wxDefaultSize, 0);
-  m_rbNetProtoGPSD->Enable(TRUE);
-  bSizer16->Add(m_rbNetProtoGPSD, 0, wxALL, 5);
-
-  m_rbNetProtoSignalK =
-      new wxRadioButton(m_scrolledwin, wxID_ANY, _("Signal K"),
-                        wxDefaultPosition, wxDefaultSize, 0);
-  m_rbNetProtoSignalK->Enable(TRUE);
-  bSizer16->Add(m_rbNetProtoSignalK, 0, wxALL, 5);
+  //Optimize for Portrait mode handheld devices
+  if (displaySize.x < displaySize.y){
+    wxBoxSizer* bSizer16a;
+    bSizer16a = new wxBoxSizer(wxHORIZONTAL);
+    gSizerNetProps->AddSpacer(1);
+    gSizerNetProps->Add(bSizer16a, 1, wxEXPAND, 5);
+    gSizerNetProps->AddSpacer(1);
+    gSizerNetProps->AddSpacer(1);
+    m_rbNetProtoGPSD = new wxRadioButton(m_scrolledwin, wxID_ANY, _("GPSD"),
+                                         wxDefaultPosition, wxDefaultSize, 0);
+    m_rbNetProtoGPSD->Enable(TRUE);
+    bSizer16a->Add(m_rbNetProtoGPSD, 0, wxALL, 5);
+
+    m_rbNetProtoSignalK =
+        new wxRadioButton(m_scrolledwin, wxID_ANY, _("Signal K"),
+                          wxDefaultPosition, wxDefaultSize, 0);
+    m_rbNetProtoSignalK->Enable(TRUE);
+    bSizer16a->Add(m_rbNetProtoSignalK, 0, wxALL, 5);
+  }
+  else {
+    m_rbNetProtoGPSD = new wxRadioButton(m_scrolledwin, wxID_ANY, _("GPSD"),
+                                         wxDefaultPosition, wxDefaultSize, 0);
+    m_rbNetProtoGPSD->Enable(TRUE);
+    bSizer16->Add(m_rbNetProtoGPSD, 0, wxALL, 5);
 
-  gSizerNetProps->Add(bSizer16, 1, wxEXPAND, 5);
-  gSizerNetProps->AddSpacer(1);
-  gSizerNetProps->AddSpacer(1);
+    m_rbNetProtoSignalK =
+        new wxRadioButton(m_scrolledwin, wxID_ANY, _("Signal K"),
+                          wxDefaultPosition, wxDefaultSize, 0);
+    m_rbNetProtoSignalK->Enable(TRUE);
+    bSizer16->Add(m_rbNetProtoSignalK, 0, wxALL, 5);
+  }
 
   m_stNetDataProtocol =
       new wxStaticText(m_scrolledwin, wxID_ANY, _("Data Protocol"),
